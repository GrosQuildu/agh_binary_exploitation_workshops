#include <stdio.h>
#include <errno.h>
#include <unistd.h>

int main () {
    int* errno_ptr = &errno;
    char buf[64] = {};

    /* printf("%p\n%p\n", &buf, &errno_ptr); */
    
    // bug1: read do not append nullbyte. We can leak &errno (libc address)
    // bug2: overflow, we can jump to any address
    //       easiest jump is to so called one gadget
    if(read(0, buf, 0x64) == -1) {
        int error = *errno_ptr;
        printf("error reading");
        errno = error;
    }
    
    printf("%s\n", buf);

    return 0;
}
