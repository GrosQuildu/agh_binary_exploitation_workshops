FROM ubuntu:trusty

RUN sudo dpkg --add-architecture i386
RUN apt-get -y update
RUN apt-get -y install libc6:i386
RUN apt-get -y install socat gcc libc6-dev-i386
RUN apt-get -y install make

RUN groupadd -g 999 appuser && \
    useradd -r -u 999 -g appuser appuser

ADD . /app
WORKDIR /app

RUN make
RUN chown appuser:appuser /app -R
RUN chmod 755 /app/launch.sh

USER appuser
CMD /app/launch.sh
